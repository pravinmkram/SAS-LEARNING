data sort_new(drop=I J temp_code Temp_weight keep= code1- code7 weight1-weight7) ;
set overall_weight;
array code(21) $30. code1-code21;
array weight(21)  weight1-weight15;
do I=1 to 21;
do J=1 to 21-I;
if not missing(code(J+1)) and  weight(J) <  weight(J+1) then do;
Temp_weight= weight(J);
weight(J)=  weight(J+1);
weight(J+1) = Temp_weight;
Temp_code = code(J);
code(J)= code(J+1);
code(J+1) = Temp_code;
end; end; end;
run; 
